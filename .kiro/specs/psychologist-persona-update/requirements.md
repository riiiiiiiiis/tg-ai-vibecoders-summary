# Requirements Document

## Introduction

Обновление AI-персоны "Психолог сообществ" для создания шуточного анализа участников чата. Вместо традиционного психологического профилирования, персона будет анализировать стиль письма участников и делать юмористические предположения о том, какая языковая модель (GPT-4, Claude, Gemini и т.д.) могла бы генерировать такие сообщения.

## Glossary

- **AI Persona** — Специализированный AI-аналитик с уникальным стилем и фокусом анализа
- **Психолог сообществ** — Одна из шести AI-персон в системе, фокусирующаяся на анализе участников
- **Лексический анализ** — Анализ стиля письма, лексики, структуры предложений и паттернов коммуникации
- **LLM (Large Language Model)** — Большая языковая модель (GPT, Claude, Gemini и др.)
- **Prompt** — Системный промпт, определяющий поведение AI-персоны

## Requirements

### Requirement 1

**User Story:** Как администратор чата, я хочу получить шуточный анализ участников в стиле "угадай модель", чтобы развлечь сообщество и добавить юмора в аналитику

#### Acceptance Criteria

1. WHEN пользователь генерирует отчет для персоны "Психолог сообществ", THE System SHALL создать анализ, предполагающий что все участники — это боты с разными LLM
2. THE System SHALL упоминать никнеймы участников (@username или имя) в анализе для получения уведомлений
3. THE System SHALL проводить лексический анализ последних сообщений каждого активного участника
4. THE System SHALL делать предположения о конкретной языковой модели для каждого участника
5. THE System SHALL использовать юмористический и легкий тон в описаниях

### Requirement 2

**User Story:** Как пользователь системы, я хочу видеть конкретные модели и их характеристики в анализе, чтобы понимать на чем основаны предположения

#### Acceptance Criteria

1. THE System SHALL упоминать реальные названия моделей (GPT-4, Claude 3.5 Sonnet, Gemini 2.0 Pro, Llama 3, Mistral и др.)
2. THE System SHALL описывать характерные признаки стиля письма для каждой предполагаемой модели
3. THE System SHALL связывать особенности сообщений участника с характеристиками конкретной модели
4. THE System SHALL включать примеры фраз или паттернов из сообщений участника
5. THE System SHALL форматировать вывод как список участников с их "моделями"

### Requirement 3

**User Story:** Как разработчик, я хочу обновить промпт и схему валидации для персоны "Психолог", чтобы система корректно обрабатывала новый формат ответа

#### Acceptance Criteria

1. THE System SHALL обновить системный промпт в `lib/ai/prompts.ts` для персоны `psychologist`
2. THE System SHALL обновить Zod-схему в `lib/ai/schemas.ts` для валидации нового формата
3. THE System SHALL сохранить структуру ответа совместимой с существующим UI компонентом
4. THE System SHALL обеспечить корректное отображение результатов в `MultiStyleSummaryGenerator`
5. THE System SHALL поддерживать отправку обновленного формата в Telegram

### Requirement 4

**User Story:** Как администратор, я хочу чтобы анализ был основан на реальных данных участников, чтобы шутка была релевантной и персонализированной

#### Acceptance Criteria

1. THE System SHALL анализировать минимум 5-10 последних сообщений каждого активного участника
2. THE System SHALL учитывать длину сообщений, сложность лексики, структуру предложений
3. THE System SHALL учитывать использование эмодзи, пунктуации, форматирования
4. THE System SHALL учитывать тематику и стиль коммуникации (формальный/неформальный)
5. THE System SHALL фокусироваться на топ-5 до топ-10 самых активных участниках периода
