# Product Requirements Document (PRD)

## Telegram Analytics Dashboard

**Version:** 1.0  
**Last Updated:** January 2025  
**Status:** Active Development

---

## Executive Summary

Telegram Analytics Dashboard ‚Äî —ç—Ç–æ read-only –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ AI-–∏–Ω—Å–∞–π—Ç–æ–≤ Telegram-—Å–æ–æ–±—â–µ—Å—Ç–≤. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π PostgreSQL –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –≤–ª–∞–¥–µ–ª—å—Ü–∞–º —á–∞—Ç–æ–≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ AI-–∞–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ –æ–±—â–µ–Ω–∏—è.

**–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ read-only –∏ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ SELECT-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

---

## Problem Statement

### –ü—Ä–æ–±–ª–µ–º–∞
–í–ª–∞–¥–µ–ª—å—Ü—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã Telegram-—á–∞—Ç–æ–≤ –Ω–µ –∏–º–µ—é—Ç —É–¥–æ–±–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –¥–ª—è:
- –ê–Ω–∞–ª–∏–∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∑–∞ —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã
- –ü–æ–Ω–∏–º–∞–Ω–∏—è —Ç–µ–º –∏ –¥–∏–Ω–∞–º–∏–∫–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π
- –ü–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Å–∞–π—Ç–æ–≤ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
- –ò–¥–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –≤–æ–≤–ª–µ—á–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

### –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã Telegram-—á–∞—Ç–æ–≤ –∏ –∫–∞–Ω–∞–ª–æ–≤
- –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã —Å–æ–æ–±—â–µ—Å—Ç–≤
- –ö–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ã
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ–¥–∏–∞

### –¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ
Telegram –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –Ω–æ –æ–Ω–∞:
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –ø—Ä–æ—Å—Ç—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –ù–µ –¥–∞–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ù–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç AI-–∏–Ω—Å–∞–π—Ç—ã
- –ù–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã

---

## Product Vision

–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π, –±—ã—Å—Ç—Ä—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π read-only –¥–∞—à–±–æ—Ä–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ Telegram-—á–∞—Ç–æ–≤ –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ AI-–∏–Ω—Å–∞–π—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –ø–æ–º–æ–≥–∞—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞—Ç—å —Å–≤–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ.

---

## Goals & Success Metrics

### Business Goals
1. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞–º —á–∞—Ç–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
2. –ü–æ–º–æ—á—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ AI-–∞–Ω–∞–ª–∏–∑–∞
3. –û–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π read-only –¥–æ—Å—Ç—É–ø –∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

### Success Metrics
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞ < 2 —Å–µ–∫—É–Ω–¥
- –£—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è AI-–æ—Ç—á–µ—Ç–æ–≤ > 95% –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ —á–∞—Ç–æ–≤ —Å 10,000+ —Å–æ–æ–±—â–µ–Ω–∏–π
- Zero write operations –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

### Non-Goals
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ
- –†–µ–∞–ª—Ç–∞–π–º-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –≤–µ–±)

---

## User Stories & Use Cases

### Primary Use Cases

#### UC1: –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–Ω–µ–≤–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
**–ê–∫—Ç–æ—Ä:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —á–∞—Ç–∞  
**–¶–µ–ª—å:** –£–≤–∏–¥–µ—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞  
**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É `/`
2. –í–∏–¥–∏—Ç –º–µ—Ç—Ä–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π, —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ —Å—Å—ã–ª–∫–∞–º–∏
3. –í–∏–¥–∏—Ç —Ç–æ–ø-5 —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
4. –ú–æ–∂–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —á–∞—Ç—É —á–µ—Ä–µ–∑ `?chat_id=`

#### UC2: –ê–Ω–∞–ª–∏–∑ –Ω–µ–¥–µ–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤
**–ê–∫—Ç–æ—Ä:** –ö–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä  
**–¶–µ–ª—å:** –ü–æ–Ω—è—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é  
**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ `/week`
2. –í–∏–¥–∏—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ 7 –¥–Ω–µ–π
3. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –¥–Ω–µ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
4. –ú–æ–∂–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —á–∞—Ç—É

#### UC3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è AI-–∏–Ω—Å–∞–π—Ç–æ–≤
**–ê–∫—Ç–æ—Ä:** –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä  
**–¶–µ–ª—å:** –ü–æ–ª—É—á–∏—Ç—å AI-–∞–Ω–∞–ª–∏–∑ —Ç–µ–º –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è  
**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å" –≤ —Å–µ–∫—Ü–∏–∏ AI
2. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ Google Gemini
3. –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç: summary, themes, insights
4. –í–∏–¥–∏—Ç –ø—Ä–æ—Ñ–∏–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∏–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
5. –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–∏–¥–∏—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º

#### UC4: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —á–∞—Ç—É
**–ê–∫—Ç–æ—Ä:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Ç–æ–≤  
**–¶–µ–ª—å:** –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —á–∞—Ç  
**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç `?chat_id=123` –∫ URL
2. –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ AI-–∞–Ω–∞–ª–∏–∑ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ —ç—Ç–æ–º—É —á–∞—Ç—É
3. –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —á–∞—Ç–∞–º–∏ —á–µ—Ä–µ–∑ URL

---

## Functional Requirements

### FR1: Analytics Dashboard
- **FR1.1** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∑–∞ 24 —á–∞—Å–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- **FR1.2** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∑–∞ 7 –¥–Ω–µ–π –Ω–∞ `/week`
- **FR1.3** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `chat_id` —á–µ—Ä–µ–∑ query –ø–∞—Ä–∞–º–µ—Ç—Ä
- **FR1.4** –¢–æ–ø-5 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–æ–±—â–µ–Ω–∏–π
- **FR1.5** –ü–æ–¥—Å—á–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ —Å—Å—ã–ª–∫–∞–º–∏
- **FR1.6** –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### FR2: AI Report Generation
- **FR2.1** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –ø–æ –∫–Ω–æ–ø–∫–µ "–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å"
- **FR2.2** –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-–æ—Ç–≤–µ—Ç –æ—Ç AI (summary, themes, insights)
- **FR2.3** –î–≤–∞ —Ä–µ–∂–∏–º–∞: —Å —Ç–µ–∫—Å—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ç–æ–ª—å–∫–æ –º–µ—Ç—Ä–∏–∫–∏
- **FR2.4** –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ Zod —Å—Ö–µ–º—ã
- **FR2.5** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ loading —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **FR2.6** –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

### FR3: Database Access
- **FR3.1** Read-only –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
- **FR3.2** Connection pooling –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **FR3.3** –¢–æ–ª—å–∫–æ SELECT –∑–∞–ø—Ä–æ—Å—ã
- **FR3.4** –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **FR3.5** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ chat_id –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–∞–º

### FR4: API Endpoints
- **FR4.1** `GET /api/overview` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- **FR4.2** `GET /api/report/[kind]` ‚Äî AI-–æ—Ç—á–µ—Ç—ã (generate, insights, preview)
- **FR4.3** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: `{ ok, data?, error? }`
- **FR4.4** Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `chat_id`, `days`, `date`

---

## Non-Functional Requirements

### NFR1: Performance
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞ < 2 —Å–µ–∫—É–Ω–¥
- AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è < 30 —Å–µ–∫—É–Ω–¥
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 100,000 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∞–Ω–∞–ª–∏–∑–µ
- Connection pooling –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ë–î

### NFR2: Security
- **Read-only –¥–æ—Å—Ç—É–ø –∫ –ë–î** (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π –≤ environment variables
- No user authentication (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

### NFR3: Reliability
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ AI
- Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è AI –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–Ω—è—Ç–Ω—ã–µ error messages –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–ª—è debugging

### NFR4: Maintainability
- TypeScript strict mode
- Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (components, lib, api)
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
- ESLint –¥–ª—è code quality

### NFR5: Scalability
- Server-side rendering –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- Connection pooling –¥–ª—è –ë–î
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è AI (80,000 —Å–∏–º–≤–æ–ª–æ–≤)

---

## Technical Architecture

### Technology Stack
- **Frontend:** Next.js 15 (App Router), React 19 RC, TypeScript 5.5
- **Backend:** Next.js API Routes, Node.js
- **Database:** PostgreSQL (read-only via `pg` driver)
- **AI:** OpenRouter API (Google Gemini 2.5 Pro)
- **Validation:** Zod 3.23.8
- **Styling:** Custom CSS (minimal)

### Database Schema
```sql
-- Read-only access to these tables
messages (
  id BIGINT PRIMARY KEY,
  user_id BIGINT,
  chat_id BIGINT,
  text TEXT,
  sent_at TIMESTAMP
)

users (
  id BIGINT PRIMARY KEY,
  first_name TEXT,
  last_name TEXT,
  username TEXT
)
```

### API Design
```
GET /api/overview?chat_id={id}&days={1|7}
Response: { ok: true, data: { totalMessages, uniqueUsers, messagesWithLinks, topUsers } }

GET /api/report/generate?chat_id={id}&days={1|7}
Response: { ok: true, data: { summary, themes, insights, participants } }
```

### Data Flow
1. User requests page ‚Üí Next.js SSR
2. Server queries PostgreSQL (SELECT only)
3. Data rendered in React components
4. User clicks "–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å" ‚Üí Client-side fetch
5. API route queries DB + calls OpenRouter
6. AI response validated via Zod
7. Structured data returned to client

---

## User Interface

### Pages
1. **`/` (24 —á–∞—Å–∞)** ‚Äî –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–Ω–µ–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
2. **`/week` (7 –¥–Ω–µ–π)** ‚Äî –ù–µ–¥–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### Components
- **MetricCard** ‚Äî –ö–∞—Ä—Ç–æ—á–∫–∞ —Å —á–∏—Å–ª–æ–≤–æ–π –º–µ—Ç—Ä–∏–∫–æ–π
- **TopUsers** ‚Äî –°–ø–∏—Å–æ–∫ —Ç–æ–ø-—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- **AiInsights** ‚Äî –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ AI-–æ—Ç—á–µ—Ç–∞
- **SummaryGenerator** ‚Äî –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å loading —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### Language
- –í–µ—Å—å UI –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π, —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Ç–æ–Ω (–Ω–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π)

---

## Dependencies & Integrations

### Required Services
1. **PostgreSQL Database**
   - Existing schema with messages and users
   - Read-only credentials
   - Network access from application

2. **OpenRouter API**
   - Valid API key
   - Model: `google/gemini-2.5-pro`
   - Internet connectivity

### Environment Variables
```bash
# Required
DATABASE_URL=postgresql://user:pass@host:5432/db
OPENROUTER_API_KEY=sk-or-v1-...
OPENROUTER_MODEL=google/gemini-2.5-pro

# Optional
OPENROUTER_TIMEOUT_MS=20000
LLM_DEBUG_VERBOSE=1
LLM_TEXT_CHAR_BUDGET=80000
```

---

## Security Considerations

### Database Security
- ‚úÖ Read-only database user with SELECT-only permissions
- ‚úÖ Parameterized queries (no string concatenation)
- ‚úÖ Input validation on all query parameters
- ‚úÖ Connection pooling with limits
- ‚ùå No INSERT, UPDATE, DELETE, DROP operations
- ‚ùå No dynamic SQL generation

### API Security
- API keys stored in environment variables (not in code)
- No user authentication (internal tool assumption)
- Rate limiting considerations for AI API
- Error messages don't expose sensitive data

### Data Privacy
- No data modification or deletion
- No data export features (view-only)
- AI analysis uses aggregated/anonymized data where possible

---

## Risks & Mitigations

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| AI API unavailable | High | Medium | Graceful degradation, show metrics only |
| Database connection issues | High | Low | Connection pooling, retry logic |
| Slow queries on large datasets | Medium | Medium | Indexed queries, query optimization |
| Accidental write operations | Critical | Low | Read-only DB user, code review |
| AI response format changes | Medium | Low | Zod validation, error handling |

---

## Future Enhancements (Out of Scope for v1)

- üìä –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–Ω–¥–æ–≤
- üìÖ –í—ã–±–æ—Ä –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –¥–∞—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- üîî –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ PDF/CSV
- ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Bot –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á–µ—Ç–æ–≤
- üåê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤ (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
- üë• Multi-user access —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ (week-over-week)
- üéØ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ KPI

---

## Glossary

- **Read-only** ‚Äî –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ SELECT –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
- **AI Insights** ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á–∞—Ç–∞ —á–µ—Ä–µ–∑ LLM (summary, themes, insights)
- **OpenRouter** ‚Äî API-—Å–µ—Ä–≤–∏—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º LLM –º–æ–¥–µ–ª—è–º
- **Connection Pooling** ‚Äî –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **SSR** ‚Äî Server-Side Rendering, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **Zod** ‚Äî TypeScript-first –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ö–µ–º –¥–∞–Ω–Ω—ã—Ö

---

## Approval & Sign-off

**Product Owner:** _[Pending]_  
**Tech Lead:** _[Pending]_  
**Date:** _[Pending]_

---

**Document Status:** ‚úÖ Ready for Review
